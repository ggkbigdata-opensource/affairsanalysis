/*! qianjing[qianjing02@baidu.com] 2016-02-01 */
(function(t){function e(t){var e=t[0],a=t.slice(1);if(_.isFunction(this[e])){var r=e;void 0!==this.list[e]&&(r=n.chart.guid(e)),this.list[r]=this[e].apply(this,a)}else n.error(e+" \u4e0d\u5b58\u5728")}function a(t){if(_.isArray(t[0]))for(var a=0,r=t.length;r>a;a++){var i=t[a]||{};e.call(this,i)}else e.call(this,t)}function r(t,r){switch(this.chartid=n.chart.guid("chart"),this.paper=t,this.list={},this.paperset={},r[0]){case"list":a.call(this,r[1]);break;case"fn":r[1].call(this);break;default:e.call(this,r)}}function i(t,e,a,r,i,n){var s=(a-t)/2,o=(i-a)/2,h=Math.atan((a-t)/Math.abs(r-e)),l=Math.atan((i-a)/Math.abs(r-n));h=r>e?Math.PI-h:h,l=r>n?Math.PI-l:l;var u=Math.PI/2-(h+l)%(2*Math.PI)/2,f=s*Math.sin(u+h),p=s*Math.cos(u+h),c=o*Math.sin(u+l),d=o*Math.cos(u+l);return{x1:a-f,y1:r+p,x2:a+c,y2:r+d}}var n={version:"2.0.1"};n.log=function(){console.log.apply(console,arguments)},n.error=function(t){throw Error(t)},n.hasSVG=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}(),n.randomColor=function(){var t=Math.floor(16777215*Math.random()).toString(16).toUpperCase();return"#"+"000000".substring(0,6-t)+t},n.replaceAll=function(t,e,a){return t.replace(RegExp(e,"gm"),a)},n.type=function(t){return $.type(t)},n.toFixed=function(t,e){return""===t?"":parseFloat(t).toFixed(e)},n.truncate=function(t,e){var a=e,r=t.replace(/[^\x00-\xff]/g,"**"),i=r.substring(0,a),n=i.split("*").length-1,s=n/2;a-=s;var o=t.substring(0,a);return t.length>a?o+"\u2026":o};var s=function(t){return(t+"").replace(RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1")};n.getQueryValue=function(t,e){var a=RegExp("(^|&|\\?|#)"+s(e)+"=([^&#]*)(&|$|#)",""),r=t.match(a);return r?r[2]:null},n.stringify=function(){function t(t){return/["\\\x00-\x1f]/.test(t)&&(t=t.replace(/["\\\x00-\x1f]/g,function(t){var e=i[t];return e?e:(e=t.charCodeAt(),"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16))})),'"'+t+'"'}function e(t){var e,a,r,i=["["],n=t.length;for(a=0;n>a;a++)switch(r=t[a],typeof r){case"undefined":case"function":case"unknown":break;default:e&&i.push(","),i.push(baidu.json.stringify(r)),e=1}return i.push("]"),i.join("")}function a(t){return 10>t?"0"+t:t}function r(t){return'"'+t.getFullYear()+"-"+a(t.getMonth()+1)+"-"+a(t.getDate())+"T"+a(t.getHours())+":"+a(t.getMinutes())+":"+a(t.getSeconds())+'"'}var i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(a){switch(typeof a){case"undefined":return"undefined";case"number":return isFinite(a)?a+"":"null";case"string":return t(a);case"boolean":return a+"";default:if(null===a)return"null";if(a instanceof Array)return e(a);if(a instanceof Date)return r(a);var i,s,o=["{"],h=n.stringify;for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l))switch(s=a[l],typeof s){case"undefined":case"unknown":case"function":break;default:i&&o.push(","),i=1,o.push(h(l)+":"+h(s))}return o.push("}"),o.join("")}}}(),n.parse=function(t){return $.parseJSON(t)},n.define=function(t,e,a){var r;if(_.isObject(t))r=t;else{r=a||this;var i,n,s=0;if(t.indexOf(".")>-1)for(i=t.split("."),s="G"===i[0]?1:0,n=i.length;n>s;s++)r[i[s]]=s===n-1?e:r[i[s]]||{},r=r[i[s]];else r[t]=e,r=r[t]}return void 0===r.fire&&(r.fire=function(t){var e=this;if(t.indexOf(":")>-1){t=t.split(":");for(var a=0,r=t.length;r>a;a++)e[t[a]]&&(e=e[t[a]])}else e=this[t];e.apply(this,_.toArray(arguments).slice(1))}),void 0!==r.ready&&$(function(){r.ready()}),r},n.define("date",{DATE_PATTERN:/^(\d{4})\D*(\d{2})\D*(\d{2})/,DATE_DAYS:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],parse:function(t){var e=(""+t).length;if(11>=e&&this.DATE_PATTERN.test(t)){var a=(""+t).match(this.DATE_PATTERN);return Date.parse(a[2]+"/"+a[3]+"/"+a[1])}return e>=12?t:void 0},format:function(t,e){function a(t,a){e=e.replace(t,a)}var r=new Date(this.parse(t)),i=function(t,e){var a="",r=0>t,i=Math.abs(t)+"";return e>i.length&&(a=Array(e-i.length+1).join("0")),(r?"-":"")+a+i},n=r.getFullYear(),s=r.getMonth()+1,o=r.getDate();return a(/yyyy/g,i(n,4)),a(/yy/g,i(parseInt((""+n).slice(2),10),2)),a(/MM/g,i(s,2)),a(/M/g,s),a(/dd/g,i(o,2)),a(/d/g,o),e},between:function(t,e){return Math.abs((this.parse(t)-this.parse(e))/864e5)},startDay:1,getDayInWeek:function(t){var e=new Date(this.parse(t)).getDay(),a=this.DATE_DAYS,r=1===this.startDay?0===e?6:e-1:e;return{k:r,v:a[e]}},getWeekArray:function(t,e){t=this.getDate(t,0),e=this.getDate(e,0);var a=this.getDayInWeek(t),r=a.k,i=[],n=6-r,s=this.between(t,e)+1,o=1,h=s-n;if(n>s)return[t+"|"+e];for(i.push(t+"|"+this.getDate(t,n));h>=o;o+=7){var l=this.getDate(t,n+o),u=this.getDate(t,n+o+6);if(l>e)break;u>e&&(u=e),i.push(l+"|"+u)}return i},getLastDayOfMonth:function(t){var e=+t.slice(0,4),a=+t.slice(4,6);return 12===a?(e+=1,a=1):a+=1,this.getDate(""+e+(10>a?"0"+a:a)+"01",-1)},isLeapYear:function(t){var e=new Date(this.parse(t)).getYear();return 0===e%4&&(0!==e%100||0===e%400)},getYearArray:function(t,e){var a=new Date(this.parse(t)).getFullYear(),r=new Date(this.parse(e)).getFullYear(),i=[],n=a;for(a>r&&(n=r,r=a);r>=n;n++)i.push(n);return i},getMonthArray:function(t,e){var a=new Date(this.parse(t)),r=new Date(this.parse(e));if(a>r){var i=a;a=r,r=i}for(var n=a.getFullYear(),s=r.getFullYear(),o=a.getMonth()+1,h=r.getMonth()+1,l=[],u=n,f=o,p=12*(s-n)+h;s>=u;u++)for(;p>=f;f++)if(l.push(u+""+(f>9?f:"0"+f)),12===f){f=1,p-=12;break}return l},getSeasonArray:function(t,e){for(var a,r=this.getMonthArray(t,e),i=0,n=r.length,s=[];n>i;i++)a=r[i].substr(4),("01"===a||"04"===a||"07"===a||"10"===a)&&s.push(r[i]);return s},getDate:function(t,e,a){return e=e||0,a=a||"yyyyMMdd",this.format(this.parse(t)+864e5*e,a)},getDayArray:function(t,e,a,r){r=r||"yyyyMMdd";var i=this.between(t,e);a>=i&&(a=i);var n=[],s=0,o=0,h=a>1?a-1:i,l=Math.floor(i/h),u=i%a;for(n.push(this.getDate(t,0,r));h>o;o++)s+=l,s+=u-->0?1:0,n.push(this.getDate(t,s,r));return n},getWeekNumber:function(t,e){var a=new Date(this.parse(t)),r=new Date(this.parse(e)),i=new Date(a.getFullYear(),0,1),n=Math.round((a.getTime()-i.getTime()+864e5*(i.getDay()-a.getDay()))/864e5),s=Math.round((r.getTime()-i.getTime()+864e5*(i.getDay()-r.getDay()))/864e5);return Math.ceil(s/7)-Math.ceil(n/7)},getPartOfTheYear:function(t,e){var a=this.isLeapYear(t)?366:365;if(e=e||"before","before"===e){var r=new Date(this.parse(t)).getFullYear()+"-01-01";return this.between(r,t)/a}if("after"===e){var i=new Date(this.parse(t)).getFullYear()+"-12-31";return this.between(t,i)/a}}}),n.baseUI={hooks:{},addHook:function(t,e){this.hooks[t]=e},types:{},addType:function(t,e){void 0!==this.types[t]&&n.error("\u5df2\u7ecf\u5b58\u5728"+t),this.types[t]=e},pub:function(t,e){var a=e.wrap,r=this,i=function(t,e){var a=e.type;void 0!==a&&r.types[a]?r.types[a](e):$.pub(t,e)},n=a.attr("data-hook-before");n&&this.hooks[n]&&this.hooks[n](e),i(t,e)},action:{},bind:function(){},ready:function(){this.bind()}},n.define("ui.tab",$.extend(!0,{},n.baseUI,{action:{showtabbox:function(t,e){var a=t.children("div.tab-box").eq(e);a.show().siblings("div.tab-box").hide()},click:function(t){var e=this;t=$(t);var a=t.parent();if(!t.hasClass("disable")){if(a.hasClass("tab-toggle"))t.toggleClass("active");else{if(t.hasClass("active"))return;t.addClass("active").siblings(".active").removeClass("active")}var r=t.parent().siblings(".tab-bd"),i=t.index();e.fire("action:showtabbox",r,i),e.pub("GUI_TAB_CLICK",{el:t,wrap:a,type:t.attr("data-type")||a.attr("data-type")||"",value:t.attr("data-value")||""})}}},bind:function(){var t=this;$(document).on("click","ul.tab-hd > li",function(){t.fire("action:click",this)})}})),n.define("ui.select",$.extend(!0,{},n.baseUI,{action:{selectItem:function(t){var e=this;t=$(t);var a=t.parents("div.ui-select"),r=a.find("span.ui-select-value"),i=t.attr("data-text")||$.trim(t.text());i&&r.text(i);var n=t.attr("data-type");n&&r.attr("data-type",n);var s=t.attr("data-value");s&&r.attr("data-value",s),e.pub("GUI_SELECT_ITEM",{elm:t,wrap:a,type:n||a.attr("data-type")||"",value:s||""})},toggle:function(t){t=$(t);var e=null;e=t.hasClass("ui-select")?t:t.parents("div.ui-select"),e.find("div.ui-select-layer").toggle()}},bind:function(){var t=this;$(document).on("click",function(){$("div.ui-select-layer").hide()}).on("click","div.ui-select",function(e){var a=e.target,r=a.className;r.indexOf("ui-select-item")>-1?t.fire("action:selectItem",a):r.indexOf("ui-select")>-1?(t.fire("action:toggle",a),e.stopPropagation()):e.stopPropagation()})}})),n.define("chart",{count:{},fn:{},guid:function(t){return void 0===this.count[t]&&(this.count[t]=1),t+"$"+this.count[t]++},canvas:function(){return Raphael.apply({},arguments)},CONFIG:{BASE_IMG_SRC:"/static/imgs/chart/",TITLE_STYLE:{fill:"#9A9A9A","text-anchor":"start","font-size":"18px"},ANIMATION:Raphael.svg?"on":"off",COLORS:["#3ec7f5","#2cc312","#e7882e","#f362a5","#b16ec2"],TEXT_STYLE:{fill:"#9A9A9A","text-anchor":"start"},PATH_STYLE:{stroke:"#E4E6E9",fill:"none"},GUIDE_STYLE:{stroke:"#CDCDCD",fill:"none"},DATAZOOM:{ZOOM_COLOR:"#90c5ed",HANDLE_TIPS:"zoomtips.png",HANDLE_IMG:"zoomhander.png"},TOPLINETEXT:["A","B","C","D","E","F","G","H","I","J"],ICON_AGE_IMG:["icon_age1.png","icon_age2.png","icon_age3.png","icon_age4.png","icon_age5.png"],ICON_AGE_TEXT:["19\u5c81\u53ca\u4ee5\u4e0b","20~29\u5c81","30~39\u5c81","40~49\u5c81","50\u5c81\u53ca\u4ee5\u4e0a"]}}),n.canvas=n.chart.canvas;var o=function(){};o.prototype=n.chart.fn,r.prototype=new o,r.prototype.getpaperset=function(t){return void 0===this.paperset[t]&&(this.paperset[t]=this.paper.set()),this.paperset[t]},r.prototype.draw=function(t){var e=this.paperset;if(arguments[2]){var a=arguments[1],r=arguments[2];e[t]?r.apply(e[t],[]):e[t]=a()}else{var i=arguments[1][0],n=arguments[1].slice(1);e[t]?e[t].refresh&&e[t].refresh.apply(this,n):e[t]=this[i].apply(this,n)}},r.prototype.refresh=function(t,e){e=e||{};var a=this.chartid;if("*"===t){var r=eve._events.n[a].n;for(var i in r)r[i].n.hasOwnProperty("refresh")&&this.eve(a+"."+i+".refresh",e)}else if(_.isArray(t))for(var s=0,o=t.length;o>s;s++)this.eve(a+"."+t[s]+".refresh",e);else t?this.eve(a+"."+t+".refresh",e):n.error("\u7f3a\u5c11typeid\u53c2\u6570")},r.prototype.eve=function(t,e){eve(t,null,e)},Raphael.fn.chart=function(){return new r(this,Array.prototype.slice.call(arguments))},Raphael.el.popup=function(t,e,a,r){var i,n,s,o,h,l=this.paper||this[0].paper;if(l){switch(this.type){case"text":case"circle":case"ellipse":s=!0;break;default:s=!1}t=null==t?"up":t,e=e||5,i=this.getBBox(),a="number"==typeof a?a:s?i.x+i.width/2:i.x,r="number"==typeof r?r:s?i.y+i.height/2:i.y,o=Math.max(i.width/2-e,0),h=Math.max(i.height/2-e,0),this.translate(a-i.x-(s?i.width/2:0),r-i.y-(s?i.height/2:0)),i=this.getBBox();var u={up:["M",a,r,"l",-e,-e,-o,0,"a",e,e,0,0,1,-e,-e,"l",0,-i.height,"a",e,e,0,0,1,e,-e,"l",2*e+2*o,0,"a",e,e,0,0,1,e,e,"l",0,i.height,"a",e,e,0,0,1,-e,e,"l",-o,0,"z"].join(","),down:["M",a,r,"l",e,e,o,0,"a",e,e,0,0,1,e,e,"l",0,i.height,"a",e,e,0,0,1,-e,e,"l",-(2*e+2*o),0,"a",e,e,0,0,1,-e,-e,"l",0,-i.height,"a",e,e,0,0,1,e,-e,"l",o,0,"z"].join(","),left:["M",a,r,"l",-e,e,0,h,"a",e,e,0,0,1,-e,e,"l",-i.width,0,"a",e,e,0,0,1,-e,-e,"l",0,-(2*e+2*h),"a",e,e,0,0,1,e,-e,"l",i.width,0,"a",e,e,0,0,1,e,e,"l",0,h,"z"].join(","),right:["M",a,r,"l",e,-e,0,-h,"a",e,e,0,0,1,e,-e,"l",i.width,0,"a",e,e,0,0,1,e,e,"l",0,2*e+2*h,"a",e,e,0,0,1,-e,e,"l",-i.width,0,"a",e,e,0,0,1,-e,-e,"l",0,-h,"z"].join(",")};return n={up:{x:-!s*(i.width/2),y:2*-e-(s?i.height/2:i.height)},down:{x:-!s*(i.width/2),y:2*e+(s?i.height/2:i.height)},left:{x:2*-e-(s?i.width/2:i.width),y:-!s*(i.height/2)},right:{x:2*e+(s?i.width/2:i.width),y:-!s*(i.height/2)}}[t],this.translate(n.x,n.y),l.path(u[t]).attr({fill:"#000",stroke:"none"}).insertBefore(this.node?this:this[0])}},Raphael.el.tag=function(t,e,a,r){var i=3,n=this.paper||this[0].paper;if(n){var s,o,h,l=n.path().attr({fill:"#000",stroke:"#000"}),u=this.getBBox();switch(this.type){case"text":case"circle":case"ellipse":h=!0;break;default:h=!1}return t=t||0,a="number"==typeof a?a:h?u.x+u.width/2:u.x,r="number"==typeof r?r:h?u.y+u.height/2:u.y,e=null==e?5:e,o=.5522*e,u.height>=2*e?l.attr({path:["M",a,r+e,"a",e,e,0,1,1,0,2*-e,e,e,0,1,1,0,2*e,"m",0,2*-e-i,"a",e+i,e+i,0,1,0,0,2*(e+i),"L",a+e+i,r+u.height/2+i,"l",u.width+2*i,0,0,-u.height-2*i,-u.width-2*i,0,"L",a,r-e-i].join(",")}):(s=Math.sqrt(Math.pow(e+i,2)-Math.pow(u.height/2+i,2)),l.attr({path:["M",a,r+e,"c",-o,0,-e,o-e,-e,-e,0,-o,e-o,-e,e,-e,o,0,e,e-o,e,e,0,o,o-e,e,-e,e,"M",a+s,r-u.height/2-i,"a",e+i,e+i,0,1,0,0,u.height+2*i,"l",e+i-s+u.width+2*i,0,0,-u.height-2*i,"L",a+s,r-u.height/2-i].join(",")})),t=360-t,l.rotate(t,a,r),this.attrs?(this.attr(this.attrs.x?"x":"cx",a+e+i+(h?u.width/2:"text"==this.type?u.width:0)).attr("y",h?r:r-u.height/2),this.rotate(t,a,r),t>90&&270>t&&this.attr(this.attrs.x?"x":"cx",a-e-i-(h?u.width/2:u.width)).rotate(180,a,r)):t>90&&270>t?(this.translate(a-u.x-u.width-e-i,r-u.y-u.height/2),this.rotate(t-180,u.x+u.width+e+i,u.y+u.height/2)):(this.translate(a-u.x+e+i,r-u.y-u.height/2),this.rotate(t,u.x-e-i,u.y+u.height/2)),l.insertBefore(this.node?this:this[0])}},Raphael.el.drop=function(t,e,a){var r,i,n,s,o,h=this.getBBox(),l=this.paper||this[0].paper;if(l){switch(this.type){case"text":case"circle":case"ellipse":r=!0;break;default:r=!1}return t=t||0,e="number"==typeof e?e:r?h.x+h.width/2:h.x,a="number"==typeof a?a:r?h.y+h.height/2:h.y,i=Math.max(h.width,h.height)+Math.min(h.width,h.height),n=l.path(["M",e,a,"l",i,0,"A",.4*i,.4*i,0,1,0,e+.7*i,a-.7*i,"z"]).attr({fill:"#000",stroke:"none"}).rotate(22.5-t,e,a),t=(t+90)*Math.PI/180,s=e+i*Math.sin(t)-(r?0:h.width/2),o=a+i*Math.cos(t)-(r?0:h.height/2),this.attrs?this.attr(this.attrs.x?"x":"cx",s).attr(this.attrs.y?"y":"cy",o):this.translate(s-h.x,o-h.y),n.insertBefore(this.node?this:this[0])}},Raphael.el.flag=function(t,e,a){var r=3,i=this.paper||this[0].paper;if(i){var n,s=i.path().attr({fill:"#000",stroke:"#000"}),o=this.getBBox(),h=o.height/2;switch(this.type){case"text":case"circle":case"ellipse":n=!0;break;default:n=!1}return t=t||0,e="number"==typeof e?e:n?o.x+o.width/2:o.x,a="number"==typeof a?a:n?o.y+o.height/2:o.y,s.attr({path:["M",e,a,"l",h+r,-h-r,o.width+2*r,0,0,o.height+2*r,-o.width-2*r,0,"z"].join(",")}),t=360-t,s.rotate(t,e,a),this.attrs?(this.attr(this.attrs.x?"x":"cx",e+h+r+(n?o.width/2:"text"==this.type?o.width:0)).attr("y",n?a:a-o.height/2),this.rotate(t,e,a),t>90&&270>t&&this.attr(this.attrs.x?"x":"cx",e-h-r-(n?o.width/2:o.width)).rotate(180,e,a)):t>90&&270>t?(this.translate(e-o.x-o.width-h-r,a-o.y-o.height/2),this.rotate(t-180,o.x+o.width+h+r,o.y+o.height/2)):(this.translate(e-o.x+h+r,a-o.y-o.height/2),this.rotate(t,o.x-h-r,o.y+o.height/2)),s.insertBefore(this.node?this:this[0])}},Raphael.el.label=function(){var t=this.getBBox(),e=this.paper||this[0].paper,a=Math.min(20,t.width+10,t.height+10)/2;if(e)return e.rect(t.x-a/2,t.y-a/2,t.width+a,t.height+a,a).attr({stroke:"none",fill:"#000"}).insertBefore(this.node?this:this[0])},Raphael.el.blob=function(t,e,a){var r,i,n,s=this.getBBox(),o=Math.PI/180,h=this.paper||this[0].paper;if(h){switch(this.type){case"text":case"circle":case"ellipse":i=!0;break;default:i=!1}r=h.path().attr({fill:"#000",stroke:"none"}),t=(+t+1?t:45)+90,n=Math.min(s.height,s.width),e="number"==typeof e?e:i?s.x+s.width/2:s.x,a="number"==typeof a?a:i?s.y+s.height/2:s.y;var l=Math.max(s.width+n,25*n/12),u=Math.max(s.height+n,25*n/12),f=e+n*Math.sin((t-22.5)*o),p=a+n*Math.cos((t-22.5)*o),c=e+n*Math.sin((t+22.5)*o),d=a+n*Math.cos((t+22.5)*o),g=(c-f)/2,v=(d-p)/2,y=l/2,x=u/2,m=-Math.sqrt(Math.abs(y*y*x*x-y*y*v*v-x*x*g*g)/(y*y*v*v+x*x*g*g)),w=m*y*v/x+(c+f)/2,M=m*-x*g/y+(d+p)/2;return r.attr({x:w,y:M,path:["M",e,a,"L",c,d,"A",y,x,0,1,1,f,p,"z"].join(",")}),this.translate(w-s.x-s.width/2,M-s.y-s.height/2),r.insertBefore(this.node?this:this[0])}},Raphael.fn.label=function(t,e,a){var r=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),r.push(a.label(),a)},Raphael.fn.popup=function(t,e,a,r,i){var n=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),n.push(a.popup(r,i),a)},Raphael.fn.tag=function(t,e,a,r,i){var n=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),n.push(a.tag(r,i),a)},Raphael.fn.flag=function(t,e,a,r){var i=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),i.push(a.flag(r),a)},Raphael.fn.drop=function(t,e,a,r){var i=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),i.push(a.drop(r),a)},Raphael.fn.blob=function(t,e,a,r){var i=this.set();return a=this.text(t,e,a).attr(Raphael.g.txtattr),i.push(a.blob(r),a)},Raphael.el.lighter=function(t){t=t||2;var e=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[e[0],e[1]],e[0]=Raphael.rgb2hsb(Raphael.getRGB(e[0]).hex),e[1]=Raphael.rgb2hsb(Raphael.getRGB(e[1]).hex),e[0].b=Math.min(e[0].b*t,1),e[0].s=e[0].s/t,e[1].b=Math.min(e[1].b*t,1),e[1].s=e[1].s/t,this.attr({fill:"hsb("+[e[0].h,e[0].s,e[0].b]+")",stroke:"hsb("+[e[1].h,e[1].s,e[1].b]+")"}),this},Raphael.el.darker=function(t){t=t||2;var e=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[e[0],e[1]],e[0]=Raphael.rgb2hsb(Raphael.getRGB(e[0]).hex),e[1]=Raphael.rgb2hsb(Raphael.getRGB(e[1]).hex),e[0].s=Math.min(e[0].s*t,1),e[0].b=e[0].b/t,e[1].s=Math.min(e[1].s*t,1),e[1].b=e[1].b/t,this.attr({fill:"hsb("+[e[0].h,e[0].s,e[0].b]+")",stroke:"hsb("+[e[1].h,e[1].s,e[1].b]+")"}),this},Raphael.el.resetBrightness=function(){return this.fs&&(this.attr({fill:this.fs[0],stroke:this.fs[1]}),delete this.fs),this},function(){var t=["lighter","darker","resetBrightness"],e=["popup","tag","flag","label","drop","blob"];for(var a in e)(function(t){Raphael.st[t]=function(){return Raphael.el[t].apply(this,arguments)}})(e[a]);for(var a in t)(function(t){Raphael.st[t]=function(){for(var e=0;this.length>e;e++)this[e][t].apply(this[e],arguments);return this}})(t[a])}(),Raphael.g={shim:{stroke:"none",fill:"#000","fill-opacity":0},txtattr:{fill:"#fff"},colors:function(){for(var t=[.6,.2,.05,.1333,.75,0],e=[],a=0;10>a;a++)t.length>a?e.push("hsb("+t[a]+",.75, .75)"):e.push("hsb("+t[a-t.length]+", 1, .5)");return e}()};var h=n.Time={};h.daysBetween=function(t,e){var a=(this.getParse(t)-this.getParse(e))/864e5;return Math.abs(a)},h.getParse=function(t){var e=t.split("-");return Date.parse(e[1]+"/"+e[2]+"/"+e[0])},h.getDay=function(t){var e=new Date(this.getParse(t)).getDay();return{k:e,v:"\u661f\u671f"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(e)}},h.isLeapYear=function(t){var e=new Date(this.getParse(t)).getYear();return 0==e%4&&(0!=e%100||0==e%400)},h.getPartOfTheYear=function(t,e){var a=this.isLeapYear(t)?366:365,e=e||"before";if("before"===e){var r=new Date(this.getParse(t)).getFullYear()+"-01-01";return this.daysBetween(r,t)/a}if("after"===e){var i=new Date(this.getParse(t)).getFullYear()+"-12-31";return this.daysBetween(t,i)/a}},h.getCommonDate=function(t){var e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();return 10>r&&(r="0"+r),10>i&&(i="0"+i),a+"-"+r+"-"+i},h.getYearArray=function(t,e){for(var a=[],r=new Date(this.getParse(t)).getFullYear(),i=new Date(this.getParse(e)).getFullYear(),n=r;i>=n;n++)a.push(n);return a},h.getMonthArray=function(t,e){for(var a=t.split("-"),r=e.split("-"),i=a[0],n=r[0],s=+a[1],o=12*(n-i)+Math.floor(r[1]),h=[],l=i,u=s,f=o;n>=l;l++)for(;f>=u;u++)if(h.push(l+"-"+(u>9?u:"0"+u)),12===u){u=1,f-=12;break}return h},h.getSeasonArray=function(t,e){for(var a,r,i=this.getMonthArray(t,e),n=[],s=0,o=i.length;o>s;s++)a=i[s].split("-"),r=a[1],("01"===r||"04"===r||"07"===r||"10"===r)&&n.push(i[s]);return n},h.getTimeArray=function(t,e,a){var r=this.daysBetween(t,e),a=a-1,i=[],n=0,s=0,o=Math.floor(r/a),h=r%a;for(i.push(t);a>s;s++)n+=o,n+=h-->0?1:0,i.push(this.getDate(t,n));return i},h.getDate=function(t,e){var a=864e5,r=new Date(this.getParse(t)).getTime();return r+=e*a,this.getCommonDate(r)},h.fixedtime=function(t){for(var e=t.split("|"),a=0,r=e.length;r>a;a++){var t=e[a];e[a]=t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6,8)}return e},h.checkTimeLength=function(t){var e=t[0],a=t[1];return this.daysBetween(e,a)},h.dateformat=function(t,e){var a=t.split("-"),r=a[0],i=a[1],n=a[2];return arguments[2]===!0&&(r=Math.floor(r),i=Math.floor(i),n=Math.floor(n)),e.replace("Y",""+r).replace("M",""+i).replace("D",""+n)},h.getYearWeek=function(t,e){t=new Date(this.getParse(t)),e=new Date(this.getParse(e));var a=new Date(t.getFullYear(),0,1),r=Math.round((t.getTime()-a.getTime()+864e5*(a.getDay()-t.getDay()))/864e5),i=Math.round((e.getTime()-a.getTime()+864e5*(a.getDay()-e.getDay()))/864e5);return Math.ceil(i/7)-Math.ceil(r/7)};var h=n.Time,l=n.Utils={};l.isString=function(t){return"[object String]"==Object.prototype.toString.call(t)},l.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},l.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},l.getPointerPosition=function(e){var a=e||t.event,r=a.pageX||a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),i=a.pageY||a.clientY+(document.documentElement.scrollTop||document.body.scrollTop);return{x:r,y:i}},l.getPosition=function(t){for(var e=0,a=0;t.offsetParent;)e+=t.offsetLeft,a+=t.offsetTop,t=t.offsetParent;return e+=t.offsetLeft,a+=t.offsetTop,{x:e,y:a}},l.truncate=function(t,e){var a=e,r=t.replace(/[^\x00-\xff]/g,"**"),i=r.substring(0,a),n=i.split("*").length-1,s=n/2;a-=s;var o=t.substring(0,a);if(t.length>a)var h=o+"\u2026";else var h=o;return h},l.checkLength=function(t){for(var e=0,a=0,r=t.length;r>a;a++)e+=t.charCodeAt(a)>255?2:1;return e},l.getBeautifyValue=function(t,e){var a=this.getMinMaxValue(t);return this.getAxisStep(a.max,a.min,e)},l.getMinMaxValue=function(t){for(var e,a,r=0,i=0,n=t.length;n>i;i++)if(null!==t[i])if(this.isArray(t[i]))for(var s=0,o=t[i].length;o>s;s++){var h=void 0===t[i][s]||""===t[i][s]?0:parseFloat(t[i][s]);void 0===e&&void 0===a?(e=h,a=h):e>h?e=h:h>a&&(a=h),r++}else{var h=void 0===t[i]||""===t[i]?0:parseFloat(t[i]);void 0===e&&void 0===a?(e=h,a=h):e>h?e=h:h>a&&(a=h),r++}return 0===r?{min:0,max:0}:{min:e,max:a}},l.getAverageValue=function(t){if(this.isArray(t[0])){for(var e=[],a=0,r=t.length;r>a;a++){var i=0,n=0,s=t[a].length;if(1>s)e.push(0);else{for(;s>n;n++){var o=void 0===t[a][n]||""===t[a][n]?0:parseFloat(t[a][n]);i+=o}e.push(Math.floor(i/s))}}return e}for(var i=0,a=0,r=t.length;r>a;a++){var o=void 0===t[a]||""===t[a]?0:parseFloat(t[a]);i+=o}return Math.floor(i/r)},l.getAxisStep=function(t,e,a){a=a||7,e=e||0,a-=1,a>t-e&&(t=e+a);for(var r=t-e,i=Math.floor(Math.log(r)/Math.LN10),n=Math.pow(10,i-1),s=r/n,o=n*Math.ceil(s/a),h=Math.floor(e/n)*n,l=h+o*a;t>l;)o+=n,l=h+o*a;return[l,h,o]},l.getMaxLength=function(t){for(var e,a=0,r=t.length;r>a;a++){var i=t[a];if(this.isArray(i)){var n=i.length;(void 0===e||n>e)&&(e=n)}}return e},l.textrow=function(t,e){for(var a,r,i=0,n=t.length,s=0,o=[],h=[];n>i;i++)a=t.charCodeAt(i)>255?2:1,s+=a,s>e&&(r=i,o.push(r),s=a);if(o.length>0){for(var l,u,i=0,f=o.length;f>i;i++)l=0===i?0:o[i-1],u=o[i],h.push(t.substring(l,u)),i===f-1&&h.push(t.substring(u));return h.join("\n")}return t},l.clearpaperset=function(t){for(var e=0,a=t.length;a>e;e++)t[e].length>1?this.clearpaperset(t[e]):t[e].remove()},l.showpaperset=function(t){for(var e=0,a=t.length;a>e;e++)t[e].show()},l.hidepaperset=function(t){for(var e=0,a=t.length;a>e;e++)t[e].hide()},l.fireeventpaperset=function(t,e){for(var a=0,r=t.length;r>a;a++)t[a][e]()},l.settimefuc=function(t,e){t&&(clearTimeout(t),t=null);var a=arguments[2]||300;t=setTimeout(function(){e()},a)},l.extendparam=function(t,e,a){for(var r in e){var i=a[r];if(-1!==r.indexOf(".")){var n=r.split(".");i=a[n[0]],t[i][n[1]]=e[r]}else t[i]=e[r]}},l.rectToPath=function(t,e,a,r){return"M"+t+","+e+"L"+(t+a)+","+e+"L"+(t+a)+","+(e+r)+"L"+t+","+(e+r)+"L"+t+","+e},l.millesimal=function(t){return(""+t).replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")},l.getTimeaxisXpoint=function(t,e,a,r){var i=h.daysBetween(a[0],a[1]),n=h.daysBetween(a[0],t);return n*r/i+e},l.getTimeaxisDatepoint=function(t,e,a,r){var i=h.daysBetween(a[0],a[1]),n=Math.floor((t-e)*i/r);return h.getDate(a[0],n)};var u=Math.PI/180;l.getanglepoint=function(t,e,a,r){return{x1:t+a*Math.cos(-r*u),y1:e+a*Math.sin(-r*u)}},l.getRandomNumber=function(t,e){return t>e?0:Math.round(t+(e-t)*Math.random())},l.getAngle=function(t){return t>=0?Math.PI*t/180:Math.PI*(360+t)/180};var u=Math.PI/180;n.define("chart.math",{sector:function(t,e,a,r,i,n,s){var o=e+r*Math.cos(-i*u),h=e+r*Math.cos(-n*u),l=a+r*Math.sin(-i*u),f=a+r*Math.sin(-n*u);return t.path(["M",e,a,"L",o,l,"A",r,r,0,+(n-i>180),0,h,f,"z"]).attr(s)},getAngle:function(t,e){var a=360*t/100;return{startAngle:e,endAngle:e+a}},angle2point:function(t,e,a,r){return{x:e+r*Math.cos(-t*u),y:a+r*Math.sin(-t*u)}}}),n.define("chart.fn.categoryAxis",function(t,e,a,r,i,s,o){var h=n.chart.CONFIG,l=n.Utils,u=this,f=u.paper,o=o||{},p=u.chartid,c=o.typeid||n.chart.guid("categoryAxis"),d=u.getpaperset(c),g=function(t,e,a,r,i,n,s){var s=s||{},o=s.format;l.clearpaperset(d);var u,p,c=0,g=n.length,v=s.dir||"x",y=s.step||g/i,x=s.textStyle||h.TEXT_STYLE;if("x"===v){u=s.part||a/(i-1);for(var m=g>i?i:g;m>c;c++){var w=n[Math.floor(y*c)];o&&(w=o(w)),p=f.text(t+u*c,e,w).attr(x),c===m-1&&p.attr({"text-anchor":"end"}),d.push(p)}}};return g(t,e,a,r,i,s,o),eve.on(p+"."+c+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e&&a&&g.apply(null,a)}),{typeid:c,paperset:d,refresh:g}}),n.define("chart.fn.column",function(t,e,a,r,i,s,o){var h=n.chart.CONFIG,l=n.Utils,u=this,f=u.paper,o=o||{},p=u.chartid,c=o.typeid||n.chart.guid("column"),d=u.getpaperset(c),g=function(t,e,a,r,i,n,s){var o,u=n[0],p=n[1],s=s||{},c=s.k,g=s.limit,v=s.minheight||0,y=s.kspace,x=s.popup,m=(s.popupfn,s.rectwithfn),w=s.formatfn,M=s.colorfn;o=void 0!==s.ANIMATION?"on"===s.ANIMATION?"on":"off":"on"===h.ANIMATION?"on":"off",l.hidepaperset(d);var A,b,T=0,k=i.length,I=s.dir||"up",_=s.color;for(g&&k>g&&(k=g),c?(y?(A=a/(k*c+k+1),t+=A):A=a/(k*c+k-1),b=c*A):(A=s.space||0,b=s.col_w||(a-A*(k-1))/k);k>T;T++){var L=0===i[T]?0:r*(i[T]-p)/(u-p),D=s.col_h||L;v>D&&(D=v,L=v);var O,R=t+A*T+b*T,S=b,E=D;O="down"===I?e+L-D:e+r-L;var N=l.millesimal(i[T]);if(d[T])d[T].d=N,"on"===o?d[T].show().animate(Raphael.animation({x:R,y:O,width:S,height:E},300,"<>")):d[T].show().attr({x:R,y:O,width:S,height:E});else{var C=M?M(T):_||h.COLORS[T],F=f.rect(R,O,S,E).attr({fill:C,stroke:"none"});F.d=N,F.i=T,x&&F.hover(function(){var t=this.attr("x"),e=this.attr("y"),a=this.attr("width");this.flag=f.popup(t+a/2,e,w?w(this.d,this.i,{x:t,y:e,w:a}):this.d||"0"),s.popupStyle&&this.flag[0].attr(s.popupStyle),s.popupText&&this.flag[1].attr(s.popupText)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})}),d.push(F)}m&&m(f,F,T,R,O,S,E)}};return g(t,e,a,r,i,s,o),eve.on(p+"."+c+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e&&a&&g.apply(null,a)}),{typeid:c,paperset:d,refresh:g}}),n.define("chart.fn.cover",function(t,e,a,r,i,s){var o,h,l,u,f=(n.chart.CONFIG,n.Time),p=n.Utils,c=this,d=c.paper,s=s||{},g=c.chartid,v=s.typeid||n.chart.guid("guide"),y=c.getpaperset(v),x=y[0],m=!1,w=function(){m=!0},M=function(t){if(m!==!1){var e=h[0],a=h[1],r=h[2],i=h[3],n=p.getPointerPosition(t),s=n.x,l=n.y,u=d.canvas.parentNode,y=p.getPosition(u),x=y.x,w=y.y,M=c.coverdata,A=M[0],b=Math.round((s-x-e)*A/r);if("time"===type)var T=M[1],k=f.getDate(T,b);else var k=b;o&&eve(g+"."+v+".refresh",null,{type:"move",value:[s-x,l-w,k,[e,a,r,i]]})}},A=function(){m=!1,u&&u()},b=function(t,e,a,r,i,n){h=arguments;var s,g=n.style||{fill:"#f00",stroke:"none",opacity:0};if(u=n.outfn||null,type=p.isArray(i)?"time":"category",o=n.fn||null,"time"===type){s=f.daysBetween(i[0],i[1]);var v=i[0];c.coverdata=[s,v]}else s=i-1,c.coverdata=[s];l=a/s,x?x.attr({x:t,y:e,width:a,height:r}):(x=d.rect(t,e,a,r).attr(g),y.push(x),x.mouseover(w),x.mousemove(M),x.mouseout(A))};return b(t,e,a,r,i,s),eve.on(g+"."+v+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e?a&&b.apply(null,a):"move"===e&&o&&o.apply(null,a)}),{typeid:v,paperset:y,refresh:b}}),n.define("chart.fn.datazoom",function(t,e,a,r,i,s,o){var h,l,u,f,p,c,d,g,v,y,x,m,w=n.chart.CONFIG,M=n.Time,A=n.Utils,b=8,T=30,k=this,I=k.paper,o=o||{},_=this.chartid,L=o.typeid||n.chart.guid("datazoom"),D=k.getpaperset(L),O=I.canvas,R=function(t,e,a,r,i,n,s){h=arguments,A.clearpaperset(D);var o,s=s||{},R=s.series,S=n[0],E=n[1],N=i[0],C=i[1],F=[];S>E&&(o=S,S=E,E=o),N>S&&(S=N),E>C&&(E=C),l=s.fn||null,R&&k.draw(L+"line",["line",t,e,a,r,R,R.length,A.getBeautifyValue(R,3),{colors:["#E0E0E0"],areaopacity:1,ANIMATION:"off",type:"area"}]);var P,B,Y=M.getYearArray(N,C),G=M.getPartOfTheYear(N,"after"),j=M.getPartOfTheYear(C,"before"),X=t,U=0,z=Y.length,$=a/(z-2+G+j),V=3,H=$/V;for(F.push("M"+t+","+e+"L"+t+","+(e+r)),F.push("M"+(t+a)+","+e+"L"+(t+a)+","+(e+r)),F.push("M"+t+","+(e+r)+"L"+(t+a)+","+(e+r));z>U;U++){var W,Z=!0;if(0===U)for(50>$*G&&(Z=!1),P=1;V>P&&!(t>X+$*G-H*P);P++)W="M"+(X+$*G-H*P)+","+(e+r-5)+"L"+(X+$*G-H*P)+","+(e+r),F.push(W);else if(U===z-1&&50>$*j&&(Z=!1),W="M"+X+","+(e+r-8)+"L"+X+","+(e+r),F.push(W),z-1>U)for(P=1;V>P;P++)W="M"+(X+H*P)+","+(e+r-5)+"L"+(X+H*P)+","+(e+r),F.push(W);else if(U===z-1)for(P=1;V>P&&!(H*P>$*j);P++)W="M"+(X+H*P)+","+(e+r-5)+"L"+(X+H*P)+","+(e+r),F.push(W);Z&&(B=I.text(X,e+r/2,Y[U]).attr({fill:"#9A9A9A"}),0===U&&B.attr({"text-anchor":"start"}),D.push(B)),X+=0===U?$*G:$}D.push(I.path(F.join("")).attr({stroke:"#999",fill:"none"}));var q=M.daysBetween(N,C),J=M.daysBetween(N,S),K=M.daysBetween(N,E),Q=t+a*J/q,te=t+a*K/q,ee=te>Q?te-Q:0,ae=w.BASE_IMG_SRC+w.DATAZOOM.HANDLE_IMG;d=function(e){for(var r=[],i=0,n=e.length;n>i;i++){var s=e[i],o=Math.floor((s-t)*M.daysBetween(N,C)/a);r.push(M.getDate(N,o))}return r},g=function(){this.ox=this.attr("x"),this.ow=this.attr("width"),this.animate({"fill-opacity":.2},500)},v=function(){var t=u.attr("x"),e=u.attr("width");this.animate({"fill-opacity":1},500),eve(_+"."+L+".refresh",null,{type:"drag",value:d([t,t+e])})},y=function(t){var e=this.ox+t,a=this.ow,r=h[0],i=h[1],n=h[2],s=h[3];r>e&&(e=r),e+a>r+n&&(e=r+n-a),f.attr({x:e-5}),u.attr({x:e}),p.attr({x:e+a-5});var o=e,l=e+a;return c[0].attr({path:"M"+r+","+i+"L"+o+","+i}),c[1].attr({path:"M"+(l-1)+","+i+"L"+(r+n)+","+i}),c[2].attr({path:"M"+o+","+(i+s)+"L"+l+","+(i+s)}),I.safari(),!1},x=function(t){var e=this.ox+t,a=h[0],r=h[1],i=h[2],n=h[3];a-5>e&&(e=a-5),e>a+i-5&&(e=a+i-5),f.attr({x:e});var s=p.attr("x"),o=s>e?e:s,l=Math.abs(e-s);u.attr({x:o+5,width:l});var d=o+5,g=o+5+l;return c[0].attr({path:"M"+a+","+r+"L"+d+","+r}),c[1].attr({path:"M"+(g-1)+","+r+"L"+(a+i)+","+r}),c[2].attr({path:"M"+d+","+(r+n)+"L"+g+","+(r+n)}),I.safari(),!1},m=function(t){var e=this.ox+t,a=h[0],r=h[1],i=h[2],n=h[3];a-5>e&&(e=a-5),e>a+i-5&&(e=a+i-5),p.attr({x:e});var s=f.attr("x"),o=e>s?s:e,l=Math.abs(s-e);u.attr({x:o+5,width:l});var d=o+5,g=o+5+l;return c[0].attr({path:"M"+a+","+r+"L"+d+","+r}),c[1].attr({path:"M"+(g-1)+","+r+"L"+(a+i)+","+r}),c[2].attr({path:"M"+d+","+(r+n)+"L"+g+","+(r+n)}),I.safari(),!1},u?(u.attr({x:Q,y:e,width:ee}),O.appendChild(u[0])):(u=I.rect(Q,e,ee,30).attr({fill:w.DATAZOOM.ZOOM_COLOR,stroke:"none",opacity:.5,cursor:"e-resize"}),u.drag(y,g,v)),f?(f.attr({x:Q-5,y:e}),O.appendChild(f[0])):(f=I.image(ae,Q-5,e,b,T).attr({cursor:"e-resize"}),f.drag(x,g,v)),p?(p.attr({x:te-5,y:e}),O.appendChild(p[0])):(p=I.image(ae,te-5,e,b,T).attr({cursor:"e-resize"}),p.drag(m,g,v)),c?(c[0].attr({path:"M"+t+","+e+"L"+Q+","+e}),c[1].attr({path:"M"+te+","+e+"L"+(t+a)+","+e}),c[2].attr({path:"M"+Q+","+(e+r)+"L"+te+","+(e+r)})):(c=[],c.push(I.path("M"+t+","+e+"L"+Q+","+e).attr({stroke:"#4284E2",fill:"none"})),c.push(I.path("M"+(te-1)+","+e+"L"+(t+a)+","+e).attr({stroke:"#4284E2",fill:"none"})),c.push(I.path("M"+Q+","+(e+r)+"L"+te+","+(e+r)).attr({stroke:"#4284E2",fill:"none"})))};R(t,e,a,r,i,s,o);var S={x:0,y:1,w:2,h:3,datatimes:4,usertimes:5,opts:6};return eve.on(_+"."+L+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e?a&&(A.extendparam(h,a,S),R.apply(null,h)):"drag"===e&&l&&l(a)}),{typeid:L,paperset:D,refresh:R}
}),n.define("chart.fn.datazoomselect",function(t,e,a,r,i,s,o){var h=n.chart.CONFIG,l=n.Time,u=n.Utils;o=o||{};var f,p,c,d,g,v,y,x,m,w,M=this,A=M.paper,b=this.chartid,T=o.typeid||n.chart.guid("datazoomselect"),k=M.getpaperset(T),I=M.getpaperset(T+"2"),L=M.getpaperset(T+"3"),D=function(t){m.call(d,t.attr("x")+t.attr("width")/2)},O=function(t,e,a,r,i,n,s){f=arguments,u.clearpaperset(k),u.clearpaperset(I),u.clearpaperset(L),s=s||{};var o=s.num,O=i[0],R=i[1];p=s.fn||null,c=s.tips||null;var S=[];if(S.push("M"+t+","+e+"L"+(t+a)+","+e),k.push(A.path(S.join("")).attr({stroke:"#becde3","stroke-width":1,fill:"none"})),o){M.draw(T+"trendtimeAxis",["trendtimeAxis",t,e+40,a,r,o+1,[O,R],{textStyle:{fill:"#9A9A9A",lastline:"hidden"}}]);for(var E=a/o,N=0;o>N;N++)I.push(A.rect(t+E*N,e,E,r).attr({fill:"#c2d9fc",stroke:"none"})),L.push(A.rect(t+E*N,e-15,E,r+15).attr({fill:"#ff0000",stroke:"none",cursor:"pointer","fill-opacity":0}).click(function(){D(this)})),0!==N&&A.rect(t+E*N-2,e,4,r).attr({fill:"#d4e4fd",stroke:"none"})}var C=h.BASE_IMG_SRC+h.DATAZOOM.HANDLE_IMG,F=h.BASE_IMG_SRC+h.DATAZOOM.HANDLE_TIPS,P=function(e){return parseInt((e-t)/(a/o),10)+1},B=function(t){_.each(I,function(e,a){a===t-1?e.attr({fill:"#8eb8f7"}):e.attr({fill:"#c3dafb"})})};y=function(e,r){var i=e-t,n=a-5;0>i&&(i=0),i>a&&(i=a);var s=Math.floor(i*l.daysBetween(O,R)/n),o=l.getDate(O,s);return r?r(o):o},x=function(){this.ox=this.attr("x"),this.ow=this.attr("width"),this.animate({"fill-opacity":.2},500)},m=function(e){_.isNumber(e)&&d.attr("x",e);var r=d.attr("x");this.animate({"fill-opacity":1},500);var i=P(r);B(i);var n=t+a*(i-.5)/o;d.attr("x",n-6),c&&(g.attr({x:n-67}).hide(),v.attr({text:y(n,c),x:n+1}).hide()),eve(b+"."+T+".refresh",null,{type:"drag",value:y(n)})},w=function(t){var e=this.ox+t,a=f[0],r=(f[1],f[2]);return f[3],a-5>e&&(e=a-5),e>a+r-5&&(e=a+r-5),d.attr({x:e-6}),c&&(g.attr({x:e-67}).show(),v.attr({text:y(e,c),x:e+1}).show()),A.safari(),!1};var Y=t+a*(o-.5)/o;B(o),d?d.attr({x:Y-6,y:e}):(d=A.image(C,Y-6,e-15,12,23).attr({cursor:"move"}),d.drag(w,x,m)),c&&(g=A.image(F,Y-67,e-43,134,27).hide(),v=A.text(Y+1,e-33,y(Y,c)).attr({font:"12px Arial",fill:"#ffffff"}).hide())};O(t,e,a,r,i,s,o);var R={x:0,y:1,w:2,h:3,datatimes:4,usertimes:5,opts:6};return eve.on(b+"."+T+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e?a&&(u.extendparam(f,a,R),O.apply(null,f)):"drag"===e&&p&&p(a)}),{typeid:T,paperset:k,refresh:O}}),n.define("chart.fn.guide",function(t,e,a,r,i,s){var o=n.chart.CONFIG,h=this,l=h.paper,s=s||{},u=s.typeid||n.chart.guid("guide"),f=h.getpaperset(u),p=function(t,e,a,r,i,n){var s,n=n||{},h=n.firstline||"visible",u=n.lastline||"visible",p=n.guideStyle||o.GUIDE_STYLE,c=n.dir||"y",d=[],g=0;if("x"===c){for(s=a/i;i>=g;g++)if(!(0===g&&"hidden"===h||g===i&&"hidden"===u)){var v=t+s*g;d.push("M"+v+","+e+"L"+v+","+(e+r))}}else if("y"===c)for(s=r/i;i>=g;g++)if(!(0===g&&"hidden"===h||g===i&&"hidden"===u)){var y=e+s*g;d.push("M"+t+","+y+"L"+(t+a)+","+y)}f[0]?f[0].show().attr({path:d}).attr(p):f.push(l.path(d.join("")).attr(p))};return p(t,e,a,r,i,s),{typeid:u,paperset:f,refresh:p}}),n.define("chart.fn.legend",function(t,e,a,r,i,s){var o,h=n.chart.CONFIG,l=(n.Time,n.Utils),u=this,f=u.paper,s=s||{},p=u.chartid,c=s.typeid||n.chart.guid("legend"),d=u.getpaperset(c),g=f.set(),v=f.set(),y=function(t,e,a,r,i,n){o&&l.fireeventpaperset(g,"unclick"),l.clearpaperset(g),l.clearpaperset(d),l.clearpaperset(v);var n=n||{},s=n.textlimit;o=n.fn||null;for(var u=6,y=24,x=t,m=0,w=i.length;w>m;m++){var M=i[m],A=M,b=u*l.checkLength(M);s&&(M=l.truncate(M,s),b=u*l.checkLength(M)-10),function(t){d.push(f.rect(x,e,10,10).attr({fill:h.COLORS[t],stroke:"#fff"})),v.push(f.text(x+18,e+5,M).attr({fill:"#333","text-anchor":"start"}));var a=f.rect(x,e,28+b,13).attr({title:A,fill:"#ff0000",stroke:"none",opacity:0});g.push(a),o&&(a.attr({cursor:"pointer"}),a.click(function(){var e,a=d[t],r=v[t];"off"!==a.data("state")?(a.data("dt",a.attrs.fill),a.attr({fill:"#ccc",stroke:"#fff"}),r.attr({fill:"#999"}),a.data("state","off"),e=!0):(a.attr({fill:a.data("dt"),stroke:"#fff"}),r.attr({fill:"#333"}),a.data("state","on"),e=!1),eve(p+"."+c+".refresh",null,{type:"click",value:[t,e]})}),a.hover(function(){v[t].attr({fill:"#6e87d7"})},function(){v[t].attr({fill:"#333"})}))}(m),x+=b+y+10}};return y(t,e,a,r,i,s),eve.on(p+"."+c+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e?a&&y.apply(null,a):"click"===e&&o&&o.apply(null,a)}),{typeid:c,paperset:d,refresh:y}}),n.define("chart.fn.line",function(t,e,a,r,s,o,h,l){var u=n.chart.CONFIG,f=n.Time,p=n.Utils,c=this,d=c.paper,l=l||{},g=c.chartid,v=l.typeid||n.chart.guid("legend"),y=c.getpaperset(v);d.set();var x,m=function(t,e,a,r,n,s,o,h){function l(n,s){if(null===n||void 0===n||1>n.length)return y[s]?y[s].attr({path:""}):y.push(d.path("")),void 0;var o,l,u=0,f=[],p=[];if(1===n.length){var D=n[0],O=r*(D-M)/(w-M),R=e+r-O;f.push("M"+t+","+R+"L"+(t+a)+","+R),p.push(E,R)}else for(;m>=u;u++){var S=n[u],D=void 0===S||""===S?0:S,O=r*(D-M)/(w-M),E=t+L*u,R=e+r-O;if(p.push({x:E,y:R}),h.smooth){if(u&&u!=m){var N=t+L*(u-1),C=e+r-r*((n[u-1]||0)-M)/(w-M),F=t+L*(u+1),P=e+r-r*((n[u+1]||0)-M)/(w-M),B=i(N,C,E,R,F,P);B.y1>e+r&&(B.y1=e+r),B.y2>e+r&&(B.y2=e+r),e>B.y1&&(B.y1=e),e>B.y2&&(B.y2=e),f=f.concat([B.x1,B.y1,E,R,B.x2,B.y2])}u||(f=["M",E,R,"C",E,R])}else f.push((0===u?"M":"L")+E+","+R)}if(h.smooth&&(f=f.concat([E,R,E,R])),"line"===A)o=h.smooth?f.join(","):f.join(""),h.style?l=h.style:(l={stroke:b[s],"stroke-width":I,"stroke-opacity":T,fill:"none"},_&&(l["stroke-dasharray"]=_));else if("area"===A){if(h.smooth){var Y=p[0],G=p[p.length-1];o=f.join(",")+"L"+G.x+", "+(e+r)+"L"+t+", "+(e+r)+"L"+t+", "+Y.y}else if(1===n.length)o="M"+t+","+(e+r)+f[0].replace("M","L")+"L"+(t+a)+","+(e+r)+"L"+t+","+(e+r);else{var j=f[f.length-1],X=j.replace("L","").replace("M","").split(","),U=X[0],z="M"+t+", "+(e+r),$="L"+U+", "+(e+r),V="L"+t+", "+(e+r);o=z+f.join("")+$+V}l=h.style?h.style:{fill:b[s],stroke:"none",opacity:k}}if(y[s])if(y[s].attr(l).show(),"on"===c){var H=Raphael.animation({path:o},400,"<>");""!==y[s].attr("path")?y[s].stop(H).animate(H):y[s].stop(H).attr({path:o})}else y[s].attr({path:o});else{var W=d.path(o).attr(l);x&&W.hover(function(){eve(g+"."+v+".refresh",null,{type:"hover",value:[W,y]})},function(){}),y.push(W)}}var c,m,w=o[0],M=o[1],h=h||{},A=(h.hasborder,h.type||"line"),b=h.colors||u.COLORS,T=h.strokeopacity||1,k=h.areaopacity||.1,I=h.strokewidth||2,_=h.dasharray;c=void 0!==h.ANIMATION?"on"===h.ANIMATION?"on":"off":"on"===u.ANIMATION?"on":"off",x=h.line_f_in,p.hidepaperset(y),m=p.isArray(s)?f.daysBetween(s[0],s[1]):s-1;var L=a/m;if(p.isArray(n[0])||null===n[0]&&n.length)for(var D=0,O=n.length;O>D;D++)l(n[D],D);else l(n,0)};return m(t,e,a,r,s,o,h,l),eve.on(g+"."+v+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e?a&&m.apply(null,a):"hover"===e&&x&&x.apply(null,a)}),{typeid:v,paperset:y,refresh:m}}),n.define("chart.fn.timeAxis",function(t,e,a,r,i,s,o){var h=n.chart.CONFIG,l=n.Time,u=n.Utils,f=this,p=f.paper,o=o||{},c=f.chartid,d=o.typeid||n.chart.guid("timeAxis"),g=f.getpaperset(d),v=function(t,e,a,r,i,n,s){var s=s||{},o=s.textStyle||h.TEXT_STYLE,f=s.dir||"x",c=s.format;u.clearpaperset(g);var d,v,y=0,i=i||10,x=n[0],m=n[1],w=l.daysBetween(x,m),M=s.formattype||"Y-M-D";i>w+1&&(i=w);var A=w/i;if("x"===f)for(d=a/i;i>=y;y++){v=l.getDate(x,A*y),c&&(v=c(v,y));var b=p.text(t+d*y,e,v).attr(o);0===y&&b.attr({"text-anchor":"start"}),g.push(b)}else if("y"===f)for(d=r/i;i>=y;y++)v=l.dateformat(labels[y],M),c&&(v=c(v,y)),g.push(p.text(t,e+d*(i-y),v).attr(o))};return v(t,e,a,r,i,s,o),eve.on(c+"."+d+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e&&a&&v.apply(null,a)}),{typeid:d,paperset:g,refresh:v}}),n.define("chart.fn.trendtimeAxis",function(t,e,a,r,i,s,o){var h=(n.chart.CONFIG,n.Time),l=n.Utils,u=this,f=u.paper,o=o||{},p=u.chartid,c=o.typeid||n.chart.guid("trendtimeAxis"),d=u.getpaperset(c),g=f.set(),v=function(t,e,a,r,i,n,s){function o(t,e){R.push(["M",e,t[0],"L",e,t[1]].join(","))}function u(t,e){if(l.isArray(t[0]))for(var a=0,r=t.length;r>a;a++)o(t[a],e);else o(t,e)}var s=s||{},p={fill:"#9A9A9A"},c=(s.dir||"x",s.guide),v={stroke:"#F1F1F1",fill:"none"};s.format,l.clearpaperset(d);var y,x,m,w,M,A,b,T,k,I,_=0,i=i||10,L=n[0],D=n[1],O=h.daysBetween(L,D),R=[];if(L===D)return m=h.dateformat(L,"Y\u5e74M\u6708D\u65e5",!0),T=f.text(t+a/2,e,m).attr(p),d.push(T),void 0;if(i>O+1&&(i=O+1),60>=O){for(x=h.getTimeArray(L,D,i),_=0,y=x.length;y>_;_++)m=x[_],A=m.substr(0,4),0===_?(w=A,M="Y\u5e74M\u6708D\u65e5"):A>w?(w=A,M="Y\u5e74M\u6708D\u65e5"):M="M\u6708D\u65e5",k=l.getTimeaxisXpoint(m,t,n,a),m=h.dateformat(m,M,!0),T=f.text(k,e,m).attr(p),0===_?T.attr({"text-anchor":"start"}):_===y-1&&T.attr({"text-anchor":"end"}),d.push(T),c&&0!==_&&u(c,k);c&&(g[0]?g[0].attr({path:R.join(",")}):g.push(f.path(R.join(",")).attr(v)))}else if(30*a/O>65){for(x=h.getMonthArray(L,D),_=0,y=x.length;y>_;_++)m=x[_],k=0===_?t:l.getTimeaxisXpoint(m+"-01",t,n,a),I=x[_+1]?l.getTimeaxisXpoint(x[_+1]+"-01",t,n,a):t+a,A=m.substr(0,4),0===_?(w=A,M="M\u6708"):A>w?(w=A,M="Y\u5e74M\u6708"):M="M\u6708",m=h.dateformat(m,M,!0),0===_?I-t>40&&(T=f.text(t,e,m).attr(p),T.attr({"text-anchor":"start"}),d.push(T)):_===y-1?t+a-k>40&&(T=f.text(t+a,e,m).attr(p),T.attr({"text-anchor":"end"}),d.push(T)):(T=f.text((k+I)/2,e,m).attr(p),d.push(T)),c&&0!==_&&u(c,k);c&&(g[0]?g[0].attr({path:R.join(",")}):g.push(f.path(R.join(",")).attr(v)))}else if(90*a/O>75){for(x=h.getSeasonArray(L,D),_=0,y=x.length;y>_;_++)if(m=x[_],_!==y-1){k=l.getTimeaxisXpoint(m+"-01",t,n,a),I=x[_+1]?l.getTimeaxisXpoint(x[_+1]+"-01",t,n,a):t+a;var S=m.split("-");A=S[0],b=S[1];var E;switch(b){case"01":E="1~3\u6708";break;case"04":E="4~6\u6708";break;case"07":E="7~9\u6708";break;case"10":E="10~12\u6708";break;default:E=""}1===_?(w=A,M=E):A>w?(w=A,M="Y\u5e74"+E):M=E,m=h.dateformat(m,M,!0),T=f.text((k+I)/2,e,m).attr(p),d.push(T),c&&(u(c,k),_===y-2&&u(c,I))}c&&(g[0]?g[0].attr({path:R.join(",")}):g.push(f.path(R.join(",")).attr(v)))}else{for(x=h.getYearArray(L,D),_=0,y=x.length;y>_;_++)m=x[_],k=0===_?t:l.getTimeaxisXpoint(m+"-01-01",t,n,a),I=x[_+1]?l.getTimeaxisXpoint(x[_+1]+"-01-01",t,n,a):t+a,0===_?I-t>50&&(T=f.text(t,e,m+"\u5e74").attr(p).attr({"text-anchor":"start"}),d.push(T)):_===y-1?t+a-k>50&&(T=f.text(t+a,e,m+"\u5e74").attr(p).attr({"text-anchor":"end"}),d.push(T)):(T=f.text((k+I)/2,e,m+"\u5e74").attr(p),d.push(T),c&&(u(c,k),_===y-2&&R.push(["M",I,c[0],"L",I,c[1]].join(","))));c&&(g[0]?g[0].attr({path:R.join(",")}):g.push(f.path(R.join(",")).attr(v)))}};return v(t,e,a,r,i,s,o),eve.on(p+"."+c+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e&&a&&v.apply(null,a)}),{typeid:c,paperset:d,refresh:v}}),n.define("chart.fn.valueAxis",function(t,e,a,r,i,s,o){var h=n.chart.CONFIG,l=(n.Time,n.Utils),u=this,f=u.paper,o=o||{},p=u.chartid,c=o.typeid||n.chart.guid("valueAxis"),d=u.getpaperset(c),g=function(t,e,a,r,i,n,s){var s=s||{},o=n[0],u=n[1],p=s.textFormat,c=s.firstvalue,g=s.lastvalue,v=s.textStyle||h.TEXT_STYLE,y=s.dir||"y";l.clearpaperset(d);var x,m,w=0,i=i||5,M=(o-u)/i;if("x"===y)for(m=a/i;i>=w;w++)"hidden"===c&&0===w||"hidden"===g&&w===i||(x=parseInt(u+M*w),p&&(x=p(x)),d.push(f.text(t+m*w,e,x).attr(v)));else if("y"===y)for(m=r/i;i>=w;w++)"hidden"===c&&0===w||"hidden"===g&&w===i||(x=parseInt(u+M*w),p&&(x=p(x)),d.push(f.text(t,e+m*(i-w),x).attr(v)))};return g(t,e,a,r,i,s,o),eve.on(p+"."+c+".refresh",function(t){var t=t||{},e=t.type,a=t.value;"data"===e&&a&&g.apply(null,a)}),{typeid:c,paperset:d,refresh:g}}),n.define("chart.fn.viewbox",function(t,e,a,r){var i=n.chart.CONFIG,s=(n.Time,n.Utils),o='<div class="view-bd"><div class="view-table-wrap">#{0}</div><div class="view-bg"></div></div>',h='<tr><td class="view-dot"><span style="background:#{0}"></span></td><td class="view-label">#{1}\uff1a</td><td class="view-value">#{2}</td></tr>',l=this.paper,r=r||{},u=r.id||"viewbox",f=r.close,p=(r.limit,a||{});1>T("#"+u).length&&T(document.body).append('<div id="'+u+'" class="viewbox" style="display:none;"></div>');var c=T("#"+u),d="";if(void 0!==p.title&&(d+=new T.string(o).format([p.title])),void 0!==p.content)if(s.isArray(p.content)){for(var g="",v=p.content,y=0,x=v.length;x>y;y++)g+=new T.string(h).format([i.COLORS[y],s.truncate(v[y][0],10),s.millesimal(v[y][1])||0,v[y][0]]);d+=new T.string(o).format(['<table class="view-table">'+g+"</table>"])}else d+=new T.string(o).format([p.content]);""!==d&&(f&&(d+='<div onclick="this.parentNode.style.display=\'none\'" class="view-close">X</div>'),c.html(d));var m=l.canvas.parentNode,w=s.getPosition(m),M=w.x,A=w.y;return c.css({left:M+t+parseInt(50*(Math.random()-.5),10),top:A+e+parseInt(50*(Math.random()-.5),10),display:"block"}),c}),n.define("chart.fn.agecolumn",function(t,e,a,r,i,s){s=s||{};var o=n.chart.CONFIG,h=o.ICON_AGE_TEXT,l=this,u=l.paper,f=this.chartid,p=s.typeid||n.chart.guid("agecolumn"),c=function(t,e,a,r,i,n){n=n||{};var s=0,f=i.length,c=12,d=50,g=t+10+c*f+d*f,v=150;for(l.draw(p+"text",function(){return u.text(t+10,e+15,"\u5e74\u9f84\u5206\u5e03\uff1a").attr(o.TITLE_STYLE)},function(){this.attr({x:t+10,y:e+15})}),e+=20,l.draw(p+"guide",["guide",t,e+30,g-t-5,v,5,{dir:"y",guideStyle:{stroke:"#F1F1F1",fill:"none"}}]);f>s;s++){var y=t+10+c*s+d*s;l.draw(p+"column"+s,["column",y,e+30,d,v,i[s],[100,0],{popup:!0,formatfn:function(t){return t+"%"},k:i[s].length>2?10:5,minheight:1,kspace:i[s].length>2?!1:!0}]),l.draw(p+"list"+s,function(){return{text:u.text(y+25,e+v+50,h[s]).attr({fill:"#9A9A9A"})}},function(){this.text.attr({x:y+25,y:e+v+50})})}l.draw(p+"path",function(){return u.path("M"+t+","+(e+v+30)+"L"+g+","+(e+v+30)).attr({stroke:"#ccc",fill:"none"})},function(){this.attr({path:"M"+t+","+(e+v+30)+"L"+g+","+(e+v+30)})}),l.draw(p+"valueAxis",["valueAxis",g+30,e+30,20,v,4,[100,0],{textFormat:function(t){return t+"%"},textStyle:{fill:"#9A9A9A","text-anchor":"end"}}])};return eve.on(f+"."+p+".refresh",function(t){t=t||{};var e=t.type,a=t.value;"data"===e&&a&&c.apply(null,a)}),c(t,e,a,r,i,s),{typeid:p,refresh:c}}),n.define("chart.fn.citypie",function(t,e,a,r,i,s){s=s||{};var o=n.chart.CONFIG,h=n.chart.math,l=o.COLORS,u=this.paper,f=t+a/2,p=e+r/2,c=h.getAngle(i[0],0),d=h.getAngle(i[1],c.endAngle),g=h.getAngle(i[2],d.endAngle),v={startAngle:g.endAngle,endAngle:360},y=109;h.sector(u,f,p,y,c.startAngle,c.endAngle,{stroke:"#fff",fill:l[0],"stroke-width":1}),h.sector(u,f,p,y,d.startAngle,d.endAngle,{stroke:"#fff",fill:l[1],"stroke-width":1}),h.sector(u,f,p,y,g.startAngle,g.endAngle,{stroke:"#fff",fill:l[2],"stroke-width":1}),h.sector(u,f,p,y,v.startAngle,v.endAngle,{stroke:"#fff",fill:l[3],"stroke-width":1});var x=h.angle2point((c.startAngle+c.endAngle)/2,f,p,2*y/3-10),m=h.angle2point((d.startAngle+d.endAngle)/2,f,p,2*y/3-10),w=h.angle2point((g.startAngle+g.endAngle)/2,f,p,2*y/3-10),M=h.angle2point((v.startAngle+v.endAngle)/2,f,p,2*y/3-10);u.text(x.x,x.y,i[0]+"%"+"\n\u4e00\u7ea7\u57ce\u5e02").attr({fill:"#fff"}),u.text(m.x,m.y,i[1]+"%"+"\n\u4e8c\u7ea7\u57ce\u5e02").attr({fill:"#fff"}),u.text(w.x,w.y,i[2]+"%"+"\n\u4e09\u7ea7\u57ce\u5e02").attr({fill:"#fff"}),u.text(M.x,M.y,i[3]+"%"+"\n\u56db\u7ea7\u57ce\u5e02").attr({fill:"#fff"})}),n.define("chart.fn.sexcolumn",function(t,e,a,r,i,s){var o=n.chart.CONFIG,h=["man.png","woman.png"];s=s||{};var l=this,u=l.paper,f=this.chartid,p=s.typeid||n.chart.guid("sexcolumn"),c=function(t,e,a,r,i,n){n=n||{},l.draw(p+"text",function(){return u.text(t,e+15,"\u6027\u522b\u5206\u5e03\uff1a").attr(o.TITLE_STYLE)},function(){this.attr({x:t+10,y:e+15})}),e+=20,u.path("M"+t+","+(e+r/2)+"L"+(t+a)+","+(e+r/2)).attr(o.PATH_STYLE),u.image(o.BASE_IMG_SRC+h[0],t+20,e+r/2-72,35,58),u.image(o.BASE_IMG_SRC+h[1],t+20,e+r/2+12,35,55);var s=i[0],f=[100,100,100,100,100];f.length=s.length,l.draw(p+"mancolumngray",["column",t+80,e+10+20,a-65-80,r/2-10-12-20,f,[100,0],{dir:"up",colorfn:function(){return"#F4F4F4"},k:1,minheight:1,kspace:s.length>2?!1:!0}]),l.draw(p+"mancolumn",["column",t+80,e+10+20,a-65-80,r/2-10-12-20,s,[100,0],{popup:!0,formatfn:function(t){return t+"%"},dir:"up",k:1,minheight:1,kspace:s.length>2?!1:!0}]),l.draw(p+"manvalueAxis",["valueAxis",t+a-20,e+10+20,20,r/2-10-12-20,2,[100,0],{textFormat:function(t){return t+"%"},textStyle:{fill:"#9A9A9A","text-anchor":"end"}}]);var c=i[1],d=!(c.length>2);l.draw(p+"womencolumngray",["column",t+80,e+r/2+12,a-65-80,r/2-20-20,f,[100,0],{dir:"down",colorfn:function(){return"#F4F4F4"},k:1,minheight:1,kspace:d}]),l.draw(p+"womencolumn",["column",t+80,e+r/2+12,a-65-80,r/2-20-20,c,[100,0],{popup:!0,formatfn:function(t){return t+"%"},dir:"down",k:1,minheight:1,kspace:d}]),l.draw(p+"womenvalueAxis",["valueAxis",t+a-20,e+r/2+12,a-65-50,r/2-20-20,2,[0,100],{textFormat:function(t){return t+"%"},textStyle:{fill:"#9A9A9A","text-anchor":"end"}}])};return eve.on(f+"."+p+".refresh",function(t){t=t||{};var e=t.type,a=t.value;"data"===e&&a&&c.apply(null,a)}),c(t,e,a,r,i,s),{typeid:p,refresh:c}}),n.define("chart.fn.trendchart",function(t,e,a,r,i,s){function o(t){for(var e=T.object.clone(t)||{},a=0,r=F.length;r>a;a++)"0"===F[a]&&(e.userIndexes&&e.userIndexes[a]&&(e.userIndexes[a]=[]),e.mediaIndexes&&e.mediaIndexes[a]&&(e.mediaIndexes[a]=[]),e.forecastuserIndexes&&e.forecastuserIndexes[a]&&(e.forecastuserIndexes[a]=[]));return e}var h,l,u,f,p,c,d=n.chart.CONFIG,g=n.Time,v=n.Utils,y="\u5e73\u5747\u503c",x="\u5a92\u4f53\u6307\u6570",m=130,w=this,M=w.paper,A=this.chartid,s=s||{},b=s.newtype,k=s.viewfn,I=s.USERDATA_TEXT||"\u641c\u7d22\u6307\u6570",_=s.USER_N||6,L=s.hidevalues,D=s.typeid||n.chart.guid("trendchart"),O=s.userlimitvalues,R=w.paperset,S=M.set(),E=M.set(),N=M.set(),C=M.set(),p=null,c=null,F=Array(i.userIndexes.length+1).join("1").split(""),P=null,B=function(t,e){var a,r=t.substr(0,4);return 0===e?(P=r,a="Y/M/D"):r>P?(P=r,a="Y/M/D"):a="M/D",g.dateformat(t,a)},Y={},G=null,j=function(t,e,a){function r(t,e){if("week"===l.showtype)var a=v.getMaxLength(l.userIndexes)-1,r=t,h=t*s/a+i,c=u.getuserdata===!1?l.userIndexes[e][r]:l.getuserdata(t)[e][1];else if(b)var r=g.daysBetween(f[0],t),h=v.getTimeaxisXpoint(t,i,f,s);else if(u.useindexesdata)var h=v.getTimeaxisXpoint(t,i,f,s),r=g.daysBetween(f[0],t),c=l.userIndexes[e][r];else var h=v.getTimeaxisXpoint(t,i,f,s),c=l.getuserdata(t)[e][1];var d=n+o-o*(c-p[1])/(p[0]-p[1]);return{x:h,y:d}}G&&(clearTimeout(G),G=null);var i=Y.x,n=Y.y,s=Y.w,o=Y.h,l=h[4],u=h[5];u.control||{};var f=Y.usertimes,p=Y.values;if(f[0]===f[1])v.hidepaperset(C),v.hidepaperset(E);else{var c=r(a,0),y="M"+c.x+","+n+"L"+c.x+","+(n+o);void 0!==C[0]?C[0].attr({path:y}).show():C.push(M.path(y).attr({stroke:"#ccc",fill:"none"}));for(var x=0,m=F.length;m>x;x++)if("0"!==F[x]){var A=r(a,x),T=A.x,I=A.y;void 0!==E[x]?E[x].attr({cx:T,cy:I}).show():E.push(M.circle(T,I,3).attr({fill:"#fff",stroke:d.COLORS[x],"stroke-width":2}))}}t>s-400&&(t-=400),k&&k.apply(w,[t+100,e-50,a])},X=function(t,e,a,r,i,n){h=arguments;var n=n||{},s=n.control||{},A=o(i)||{},k=A.usertimes,P=A.datatimes,X=A.showtype||"day",U=n.optimize,z=s.topline&&"disable"!==s.topline,$=s.meanline&&"disable"!==s.meanline,V=A.mediaIndexes||null,H=s.forecast&&"disable"!==s.forecast&&A.forecastuserIndexes&&k[1]===P[1];l=A,O=n.userlimitvalues,u=n.line_f_fn||null,f=n.gettopline_fn||null,v.clearpaperset(N),v.clearpaperset(S),S.push(M.text(t,e+10,I).attr(d.TEXT_STYLE));var W=$?m:20,Z=0,q=$?a-W:a-W,J=_,K=178*J/6,Q=208+27*(J-6),te=A.userIndexes,ee=v.getMinMaxValue(te);if(H){var ae=A.forecastuserIndexes,re=v.getMinMaxValue(ae),ie=A.forecasttimes;ee.min>re.min&&(ee.min=re.min),ee.max<re.max&&(ee.max=re.max)}var ne=v.getAxisStep(ee.max,ee.min,J+1);U&&ee.min-ne[1]<ne[2]/3&&(ne[1]-=ne[2],0>ne[1]&&(ne[1]=0),ne=v.getAxisStep(ne[0],ne[1],J+1)),O&&(ne=O),L!==!0&&w.draw(D+"uservalueAxis",["valueAxis",a-2,e+Z+10,20,K,J,ne,{firstvalue:"hidden",textFormat:function(t){return v.millesimal(t)},textStyle:{fill:"#9A9A9A","text-anchor":"end"}}]),w.draw(D+"userguide",["guide",W,e+Z,a-20,K,J,{lastline:"hidden",guideStyle:{stroke:"#F1F1F1",fill:"none"}}]);var se=V?[[e+Z,e+Z+K],[e+Q,e+Q+50]]:[e+Z,e+Z+K];if(w.draw(D+"trendtimeAxis",["trendtimeAxis",W,e+Z+K+13,q,20,5,[k[0],H?ie[1]:k[1]],{format:B,textStyle:{fill:"#9A9A9A",lastline:"hidden"},guide:se}]),w.draw(D+"timeAxisguideupline",["guide",W-3,e+Z+K,q+4,25,1,{guideStyle:{stroke:"#ccc",fill:"none"},lastline:"hidden"}]),V&&w.draw(D+"timeAxisguidedownline",["guide",W-3,e+Q,q+4,25,1,{guideStyle:{stroke:"#ccc",fill:"none"},lastline:"hidden"}]),R[D+"forecastline"]&&v.hidepaperset(R[D+"forecastline"].paperset),H){var oe=g.daysBetween(k[0],ie[1]),he=g.daysBetween(k[0],k[1]),le=g.daysBetween(ie[0],ie[1]),ue=q*le/oe;w.draw(D+"forecastline",["line",W+q-ue,e+Z,ue,K,ae,"day"===X?ie:v.getMaxLength(ae),ne,{dasharray:"- "}]),q=q*he/oe}w.draw(D+"userline_area",["line",W,e+Z,q,K,te,"day"===X?k:v.getMaxLength(te),ne,{line_f_in:u,smooth:!0,opacity:.2,type:"area"}]),w.draw(D+"userline",["line",W,e+Z,q,K,te,"day"===X?k:v.getMaxLength(te),ne,{line_f_in:u,smooth:!0,type:"line"}]),Y={x:W,y:e+Z,w:q,h:K,usertimes:k,values:ne},w.draw(D+"usercover",["cover",W,e+Z,q,K,"day"===X||b?k:v.getMaxLength(te),{fn:j,outfn:function(){v.hidepaperset(E),v.hidepaperset(C),G=setTimeout(function(){T("#viewbox").hide()},200)}}]),z&&f&&f(M,W,e+Z,q,K,k,ne,A,N,F);var fe,pe,ce=te.length,de=0;if(ce>=3?(fe=50,pe=!1):2===ce?(fe=50,de=10,pe=!0):1===ce&&(fe=2,pe=!0),R[D+"mediacolumn"]&&v.hidepaperset(R[D+"mediacolumn"].paperset),$){S.push(M.text(t+30,e+Z+K+15,y).attr(d.TEXT_STYLE));var ge;v.settimefuc(p,function(){ge=void 0===A.usercolumnvalue?v.getAverageValue(te):A.usercolumnvalue,w.draw(D+"usercolumn",["column",t+de,e+Z,100-2*de,K,ge,ne,{popup:!0,formatfn:n.formatfn,k:fe,kspace:pe,minheight:1}])})}else R[D+"usercolumn"]&&v.hidepaperset(R[D+"usercolumn"].paperset);if(w.draw(D+"mediaimage",function(){return{image:M.image(d.BASE_IMG_SRC+"tbg.png",W,e+Q+1,a-20,50)}},function(){this.image.attr({x:W,y:e+Q+1,w:a-20}),V?this.image.show():this.image.hide()}),V){S.push(M.text(t,e+Q+10,x).attr(d.TEXT_STYLE));var ve=A.mediaIndexes,ye=v.getMinMaxValue(ve),xe=v.getAxisStep(ye.max,ye.min,3);U&&ye.min-xe[1]<xe[2]/3&&(xe[1]-=xe[2],0>xe[1]&&(xe[1]=0),xe=v.getAxisStep(xe[0],xe[1],3)),w.draw(D+"mediavalueAxis",["valueAxis",a-3,e+Q+10,20,50,2,xe,{firstvalue:"hidden",textFormat:function(t){return(""+t).replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")},textStyle:{fill:"#9A9A9A","text-anchor":"end"}}]),w.draw(D+"mediaguide",["guide",W,e+Q,a-20,50,2,{firstline:"hidden",guideStyle:{stroke:"#F1F1F1",fill:"none"}}]),$&&v.settimefuc(c,function(){w.draw(D+"mediacolumn",["column",t+de,e+Q,100-2*de,50,v.getAverageValue(ve),xe,{k:fe,kspace:pe,minheight:1}])}),w.draw(D+"medialine",["line",W,e+Q,q,50,ve,"day"===X?k:v.getMaxLength(ve),xe,{smooth:!0,strokeopacity:.5}])}else R[D+"medialine"]&&v.hidepaperset(R[D+"medialine"].paperset),R[D+"mediaguide"]&&v.hidepaperset(R[D+"mediaguide"].paperset),R[D+"mediavalueAxis"]&&v.hidepaperset(R[D+"mediavalueAxis"].paperset)},U={x:0,y:1,w:2,h:3,series:4,opts:5};return eve.on(A+"."+D+".refresh",function(t){var t=t||{},e=t.type,a=t.value;if("data"===e)a&&(v.extendparam(h,a,U),X.apply(null,h));else if("toggle"===e&&a){var r=a[0],e=a[1],i=a[2];F[r]="on"===e?"1":"0",i&&v.extendparam(h,i,U),X.apply(null,h)}}),X(t,e,a,r,i,s),{typeid:D,refresh:X}}),n.define("chart.fn.demand",function(t,e,a,r,i,s){s=s||{};var o=n.Utils,h=this,l=h.paper,u=this.chartid,f=s.typeid||n.chart.guid("demand"),p=null,c={CON:{group:[[100,30,10,4,8],[200,30,5,4,8],[300,30,3,4,10],[400,30,2,4,12]],angel:90,R_MIN:10,R_MAX:30,random:!0},firstload:function(){var t=this,e=t.getPoints();_.each(t.wordsgroup,function(a,r){var i=e[r],n=t.elmslist[r],s=i.length,o=a.length;s>o&&(i.length=o),_.each(n,function(e,r){i[r]&&a[r]?(e.word=a[r],e.point=i[r],t.elrun(e)):t.elhide(e)})})},getWordGroup:function(){var t,e={},a=[],r=[];return _.each(this.elmslist,function(t){_.each(t,function(t){t.word&&t.word.name&&r.push(t.word.name)})}),_.each(this.wordsgroup,function(i,n){t=[],_.each(i,function(a){a.name&&($.inArray(a.name,r)>-1?e[a.name]={value:a,group:n}:t.push(a))}),a.push(t)}),[e,a]},getAngelArea:function(t){var e=this.CON.angel,a=360/e,r=parseInt(t/e,10);return r>=a&&(r-=1),r},getAngelAreaPoints:function(t){for(var e,a=this,r=a.CON.angel,i=360/r,n=0,s=[];i>n;n++)s.push([]);return _.each(t,function(t){_.each(t,function(t){e=a.getAngelArea(t.angel),s[e].push(t)})}),s},getWordPoint:function(t,e,a){var r=_.filter(a,function(t){return t.l===e});r.length>0&&(a=r);var i,n;return _.each(a,function(e){var a=e.x-t.x,r=e.y-t.y,s=Math.pow(a*a+r*r,.5);(void 0===n||n>s)&&(n=s,i=e)}),i},refreshload:function(){var t,e,a,r,i,n=this,s=n.getPoints(),o=n.getAngelAreaPoints(s),h=this.getWordGroup(),l=h[0];_.each(n.elmslist,function(h){_.each(h,function(h){t=h.word&&h.word.name,void 0!==l[t]?(h.word=l[t].value,a=h.point,r=l[t].group,i=n.getAngelArea(a.angel),e=n.getWordPoint(a,r,o[i]),o[i]=_.filter(o[i],function(t){return!(e.l===t.l&&e.i===t.i)}),s[e.l]=_.filter(s[e.l],function(t){return e.i!==t.i}),h.point=e,n.elrun(h)):n.elhide(h,"out")})});var u=h[1];_.each(u,function(t,e){var a,r=s[e],i=n.elmslist[e];_.each(i,function(e){""===e.word&&(void 0===a?a=0:a+=1,r[a]&&t[a]&&(e.word=t[a],e.point=r[a],n.elrun(e,"in")))})})},elrun:function(t,e){var a=t.point,r=t.word,i=t.circle,n=t.text,s=a.x,h=a.y,l=this.getRadius(r.query),u=Raphael.animation({x:s,y:h+l+10},500,"<>"),f=Raphael.animation({cx:s,cy:h,r:l},500,"<>"),p=this.x0,c=this.y0,d=this.w;"in"===e&&(i.stop(f).attr({cx:p>s?0:p+d/2,cy:c+o.getRandomNumber(-200,200)}),n.stop(u).attr({x:p>s?0:p+d/2,y:c+o.getRandomNumber(-200,200)})),i.show().attr({fill:1===r.up?"#fa7c62":"#20b78e"}).stop(f).animate(f),n.show().attr({text:r.name}).stop(u).animate(u)},elhide:function(t){t.word="",t.point="",t.circle.hide(),t.text.hide()},createelmslist:function(){var t,e=this,a=e.getPoints(),r=[],i=[],n=e.CON.R_MAX;_.each(a,function(e){r=[],_.each(e,function(e){t={},t.circle=l.circle(e.x,e.y,n).attr({stroke:"#fff",fill:"#fa7c62","stroke-width":2}).hide(),t.text=l.text(e.x,e.y+n+10,"").attr({"font-size":"12px",fill:"#333"}).hide(),r.push(t)}),i.push(r)}),this.elmslist=i},participle:function(t){var e=this,a=this.getMinMaxValue(t,"r");_.each(t,function(t){t.r=e.fixNum(t.r,a.min,a.max)});for(var r=e.CON.group.length,i=[],n=0;r>n;n++)i.push([]);var s=100/r;_.each(t,function(t){var e=Math.round(t.r/s);e>=r&&(e-=1),void 0!==i[r-1-e]&&i[r-1-e].push(t)});var o,h,l,u,f;_.each(e.CON.group,function(t,e){if(o=t[3],h=t[4],l=i[e],u=l.length,u>h)i[e]=l.slice(0,h),void 0!==i[e+1]&&(i[e+1]=l.slice(h).concat(i[e+1]));else if(o>u)for(f=e+1;r>f;f++)if(void 0!==i[f]&&i[f].length>0){if(i[e]=i[e].concat(i[f]),i[e].length>=o){i[f]=i[e].slice(o),i[e]=i[e].slice(0,o);break}i[f]=[]}}),this.wordsgroup=i},fixNum:function(t,e,a){return parseInt(100*(t-e)/(a-e),10)},init:function(t,e,a,r,i,n){return this.x0=t,this.y0=e,this.w=a,this.h=r,this.minmaxvalues=this.getMinMaxValue(i,"query"),this.participle(i),n?(this.elmslist=n,this.refreshload()):(this.createelmslist(),this.firstload()),this.elmslist},draw:function(t,e,a){var r=this.getRadius(a.query),i=a.name,n=l.text(t,e+r+10,i).attr({"font-size":"12px",fill:"#333"}),s=l.circle(t,e,r).attr({stroke:"#fff",fill:1===a.up?"#fa7c62":"#20b78e","stroke-width":2});return{name:i,x:t,y:e,text:n,circle:s}},getPoints:function(){var t=this,e=[];return _.each(t.CON.group,function(a,r){var i=a[0];t.CON.random?e.push(_.shuffle(t.getPoint(i,a[1],a[2],r))):e.push(t.getPoint(i,a[1],a[2],r))}),e},getPoint:function(t,e,a,i){var s=this,h=s.x0,l=s.y0,u=this.CON.R_MAX,f=Math.ceil(2*this.getCircleAngle(u,t)),p=parseInt(360/f,10);f=360/p;for(var c=n.chart.math,d=[],g=0;p>g;g++){var v=c.angle2point(f*g+o.getRandomNumber(0,a),h,l,t+o.getRandomNumber(0,e)),y=v.x,x=v.y;x>2*u&&r-2*u>x&&d.push({x:y,y:x,l:i,i:g,angel:f*g%360})}return d},getCircleAngle:function(t,e){return 180*Math.asin(t/e)/Math.PI},getRadius:function(t){var e=this.minmaxvalues,a=e.max,r=e.min,i=this.CON.R_MIN,n=this.CON.R_MAX;return i+(t-r)*(n-i)/(a-r)},getMinMaxValue:function(t,e){var a,r;return _.each(t,function(t){var i=t[e];(void 0===a||a>i)&&(a=i),(void 0===r||i>r)&&(r=i)}),{min:a,max:r}}},d=function(t,e,a,r,i){p=arguments;var n=t+a/2,s=e+r/2+35,o=i.center,u=i.list;h.draw(f+"list",function(){return{center:l.text(n,s,o.name).attr({"font-size":"14px",fill:"#fff"}),list:c.init(n,s,a,r,u,null)}},function(){this.center.attr({text:o.name,x:n,y:s}),c.init(n,s,a,r,u,this.list)})};return eve.on(u+"."+f+".refresh",function(t){t=t||{};var e=t.type,a=t.value;"data"===e&&a&&(p[4]=a.series,d.apply(null,p))}),d(t,e,a,r,i,s),{typeid:f,refresh:d}}),t.G=n})(window);